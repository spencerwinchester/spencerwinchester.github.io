<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  html, body{
    font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;
    background:#fff;
    margin:0;
    width:600px;
    max-width:600px;
    overflow-x:hidden;
    color:#000;
  }
  .container{
    width:600px;
    max-width:600px;
    margin:0 auto;
    padding:0 0 16px;
    box-sizing:border-box;
  }
  h2{font-size:1rem;margin:12px 0 6px;color:#1c75bc;}
  table{
    width:100%;
    border-collapse:separate;
    border-spacing:0 2px;
    margin-bottom:12px;
    font-size:0.85rem;
  }
  th,td{
    border:none;
    padding:4px 2px;
    text-align:center;
    vertical-align:middle;
  }
  th:first-child, td:first-child{
    text-align:left;
    width:25%;
  }
  th:nth-child(2), td:nth-child(2),
  th:nth-child(3), td:nth-child(3){width:37.5%;}
  th:last-child{width:42px}
  td.task-cell{
    position:relative;
    min-height:40px;
  }
  select,
  input[type="text"]{
    width:100%;
    height:40px;
    min-height:40px;
    padding:0 12px;
    border-radius:6px;
    border:1px solid #d6e6f6;
    font-size:0.85rem;
    box-sizing:border-box;
    background:#fff;
  }
  .other-task{
    display:none;
    position:absolute;
    top:4px;
    left:0;
    right:0;
    height:40px;
    min-height:40px;
  }
  .other-task.is-active{display:block;}
  .task-select.other-hidden{visibility:hidden;}
  button.add-row{
    padding:10px 14px;
    margin:10px 0;
    border-radius:6px;
    border:0;
    background:#AFBACE;
    color:#fff;
    cursor:pointer;
    font-size:0.85rem;
  }
  td.actions{
    padding:4px 0;
    display:flex;
    align-items:center;
    justify-content:center;
    width:42px;
  }
  tr.disabled-row td:nth-child(2),
  tr.disabled-row td:nth-child(3){position:relative;}
  tr.disabled-row td:nth-child(2) input,
  tr.disabled-row td:nth-child(3) input{visibility:hidden;}
  tr.disabled-row td:nth-child(2)::after,
  tr.disabled-row td:nth-child(3)::after{
    content:'-';
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    width:100%;
    height:40px;
    line-height:40px;
    border:1px solid #d1d5db;
    border-radius:6px;
    background:#f3f4f6;
    color:#6b7280;
    text-align:center;
    pointer-events:none;
    box-sizing:border-box;
  }
  .delete-row{
    background:#dc3545;
    color:#fff;
    border:none;
    border-radius:6px;
    display:inline-flex;
    align-items:center;
    justify-content:center;
    width:40px;
    height:40px;
    padding:0;
    cursor:pointer;
  }
  .delete-row svg{
    width:16px;
    height:16px;
    fill:currentColor;
  }
</style>
</head>
<body>
<div class="container">
  <div id="tables-container"></div>
</div>

<script>
const categories = [
  {
    name: "",
    tasks: [
        "Walking or hiking",
        "Running or jogging",
        "Gym workouts",
        "Sports",
        "Yoga or Pilates",
        "Swimming",
        "Gardening",
        "Playing with children",
        "Playing with pets",
        "Dancing",
        "Playing musical instruments",
        "Reading or writing",
        "Travel or vacations",
        "Cycling or bike riding",
        "Motorbike riding",
        "Skiing or snowboarding",
        "Surfing",
        "Martial arts",
        "Fishing",
        "Cooking or baking",
        "Camping or caravaning",
        "Attending theme parks",
        "Social events", 
        "Volunteering activities", 
        "Community activities",
        "Other",
        "No difficulties with recreational activities"
    ]
  }
];

const container = document.getElementById('tables-container');

categories.forEach((cat,catIndex)=>{
  const div = document.createElement('div');
  div.innerHTML = `
    <h2>${cat.name}</h2>
    <table id="table_${catIndex}">
      <thead>
        <tr>
          <th>Task</th>
          <th>Before the Accident</th>
          <th>Currently</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="task-cell">
            <select name="task_${catIndex}_1" class="task-select">
              <option value="" disabled selected>-- Select --</option>
              ${cat.tasks.map(t=>`<option value="${t}">${t}</option>`).join('')}
            </select>
            <input type="text" placeholder="Please enter task" class="other-task" disabled>
          </td>
          <td><input type="text" name="before_${catIndex}_1"></td>
          <td><input type="text" name="current_${catIndex}_1"></td>
          <td class="actions">
            <button type="button" class="delete-row" aria-label="Delete row">
              <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
                <path d="M9 3a1 1 0 0 0-.894.553L7.382 5H5a1 1 0 1 0 0 2h14a1 1 0 1 0 0-2h-2.382l-.724-1.447A1 1 0 0 0 14.999 3H9Zm-3 6v10a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V9H6Zm4 2a1 1 0 0 1 2 0v8a1 1 0 1 1-2 0v-8Zm4-1a1 1 0 0 1 1 1v8a1 1 0 1 1-2 0v-8a1 1 0 0 1 1-1Z"/>
              </svg>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
    <button type="button" class="add-row" data-cat="${catIndex}">+ Add New Task</button>
  `;
  container.appendChild(div);
});

// Show text field if "Other" selected
document.addEventListener('change', function(e){
  if(e.target.classList.contains('task-select')){
    const tr = e.target.closest('tr');
    const inputOther = e.target.nextElementSibling;
    const beforeInput = tr.querySelector('td:nth-child(2) input');
    const currentInput = tr.querySelector('td:nth-child(3) input');

    const value = e.target.value;

    if (inputOther) {
      if (value === 'Other') {
        inputOther.disabled = false;
        inputOther.classList.add('is-active');
        e.target.classList.add('other-hidden');
        requestAnimationFrame(() => inputOther.focus());
      } else {
        inputOther.value = '';
        inputOther.disabled = true;
        inputOther.classList.remove('is-active');
        e.target.classList.remove('other-hidden');
      }
    }

    // Disable/enable Before & Currently inputs if "No difficulties..." or "No restrictions" is selected
    const lower = value.toLowerCase();
    const disablePair = lower.includes('no difficulties') || lower.includes('no restriction');
    if(disablePair){
      beforeInput.value = '-';
      currentInput.value = '-';
      beforeInput.disabled = true;
      currentInput.disabled = true;
      tr.classList.add('disabled-row');
      e.target.classList.remove('other-hidden');
    } else {
      beforeInput.disabled = false;
      currentInput.disabled = false;
      tr.classList.remove('disabled-row');
    }
  }
});

// Add new row button
document.addEventListener('click', function(e){
  if(e.target.classList.contains('add-row')){
    const catIndex = e.target.dataset.cat;
    const catTasks = categories[catIndex].tasks;
    const tbody = document.querySelector(`#table_${catIndex} tbody`);
    const rowCount = tbody.rows.length + 1;
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="task-cell">
        <select name="task_${catIndex}_${rowCount}" class="task-select">
          <option value="" disabled selected>-- Select --</option>
          ${catTasks.map(t=>`<option value="${t}">${t}</option>`).join('')}
        </select>
        <input type="text" placeholder="Please enter task" class="other-task" disabled>
      </td>
      <td><input type="text" name="before_${catIndex}_${rowCount}"></td>
      <td><input type="text" name="current_${catIndex}_${rowCount}"></td>
      <td class="actions">
        <button type="button" class="delete-row" aria-label="Delete row">
          <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
            <path d="M9 3a1 1 0 0 0-.894.553L7.382 5H5a1 1 0 1 0 0 2h14a1 1 0 1 0 0-2h-2.382l-.724-1.447A1 1 0 0 0 14.999 3H9Zm-3 6v10a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V9H6Zm4 2a1 1 0 0 1 2 0v8a1 1 0 1 1-2 0v-8Zm4-1a1 1 0 0 1 1 1v8a1 1 0 1 1-2 0v-8a1 1 0 0 1 1-1Z"/>
          </svg>
        </button>
      </td>
    `;
    tbody.appendChild(tr);
  }
});

// Delete row button
document.addEventListener('click', function(e){
  const btn = e.target.closest('.delete-row');
  if(!btn) return;
  const tr = btn.closest('tr');
  if(!tr) return;
  const tbody = tr.parentElement;
  const rows = tbody.querySelectorAll('tr');
  if(rows.length > 1){
    tr.remove();
    return;
  }
  const select = tr.querySelector('.task-select');
  const other = tr.querySelector('.other-task');
  const beforeInput = tr.querySelector('td:nth-child(2) input');
  const currentInput = tr.querySelector('td:nth-child(3) input');
  tr.classList.remove('disabled-row');
  if (select){
    select.value = '';
    select.classList.remove('other-hidden');
  }
  if (other){
    other.value = '';
    other.disabled = true;
    other.classList.remove('is-active');
  }
  if (beforeInput){
    beforeInput.value = '';
    beforeInput.disabled = false;
  }
  if (currentInput){
    currentInput.value = '';
    currentInput.disabled = false;
  }
});
</script>
</body>
</html>
