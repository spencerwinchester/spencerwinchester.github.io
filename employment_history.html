<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Employment History</title>
<style>
  html, body {
    font-family: Arial, sans-serif;
    background: #ffffff;
    margin: 0;
    width: 600px;
    max-width: 600px;
    overflow-x: hidden;
    color: #111827;
  }
  .form-wrapper {
    width: 600px;
    max-width: 600px;
    margin: 0 auto;
    padding: 16px 0 24px;
    box-sizing: border-box;
  }
  .instructions {
    margin: 0 0 12px;
    font-size: 15px;
    line-height: 1.4;
    color: #1f2933;
  }
  table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0 16px;
    font-size: 0.9rem;
  }
  thead tr,
  tbody tr {
    display: flex;
    gap: 12px;
    align-items: center;
  }
  thead th {
    flex: 1;
    text-align: left;
    font-size: 0.85rem;
    font-weight: 600;
    color: #4a5568;
    padding: 0 6px 4px;
  }
  thead th.actions {
    flex: 0 0 48px;
    text-align: center;
  }
  tbody tr {
    padding: 16px;
    background: #ffffff;
    border: 1px solid #dce3ef;
    border-radius: 14px;
    box-shadow: 0 6px 20px rgba(15, 23, 42, 0.08);
  }
  tbody td.field-cell {
    flex: 1;
    display: flex;
    align-items: center;
  }
  tbody td.field-cell > * {
    width: 100%;
    height: 40px;
    line-height: 24px;
  }
  tbody td.field-cell textarea {
    resize: vertical;
    min-height: 40px;
  }
  tbody td.actions {
    flex: 0 0 48px;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 0;
    background: transparent;
    border: none;
  }
  select,
  input[type="text"],
  textarea {
    width: 100%;
    padding: 0 12px;
    border: 1px solid #d0d7de;
    border-radius: 6px;
    background: #ffffff;
    box-sizing: border-box;
    font-size: 0.85rem;
    color: #111827;
    height: 40px;
    min-height: 40px;
    line-height: 24px;
  }
  textarea {
    min-height: 40px;
    height: 40px;
    padding: 10px 12px;
    resize: vertical;
  }
  select:focus,
  input:focus,
  textarea:focus {
    outline: none;
    border-color: #1c75bc;
    box-shadow: 0 0 0 3px rgba(28, 117, 188, 0.15);
  }
  .date-cell {
    display: flex;
    align-items: center;
  }
  .helper-text {
    display: block;
    margin-top: 6px;
    font-size: 12px;
    color: #6b7280;
  }
  td.actions {
    padding: 12px 8px;
    display:flex;
    align-items:center;
    justify-content:center;
    border-bottom: 1px solid #e2e8f0;
  }
  .add-btn {
    border: none;
    border-radius: 6px;
    cursor: pointer;
    padding: 10px 14px;
    font-size: 0.85rem;
    background: #AFBACE;
    color: #ffffff;
    margin-top: 16px;
    display:inline-block;
  }
  .delete-btn {
    background: #dc3545;
    color: #ffffff;
    border: none;
    border-radius: 6px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    padding: 0;
    cursor: pointer;
  }
  .delete-btn svg{
    width:16px;
    height:16px;
    fill:currentColor;
  }
</style>
</head>
<body>

<div class="form-wrapper">
  <form id="employmentForm">
    <p class="instructions">
      List each role you have held. For each, select whether it was before, at the time of, or after the accident. Add more rows if needed.
    </p>

    <table id="employmentTable">
      <thead>
        <tr>
          <th scope="col">Period</th>
          <th scope="col">Role &amp; Duties</th>
          <th scope="col">Employer</th>
          <th scope="col">Start Year</th>
          <th scope="col">End Year / Ongoing</th>
          <th scope="col">Hours per Week</th>
          <th scope="col" class="actions"></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="field-cell period-cell">
            <select name="period[]" class="period-select" aria-label="Employment period">
              <option value="" disabled selected>-- Select --</option>
              <option value="before">Before accident</option>
              <option value="at">At accident</option>
              <option value="after">After accident</option>
            </select>
          </td>
          <td class="field-cell role-cell">
            <textarea name="role_duties[]" aria-label="Role and duties"></textarea>
          </td>
          <td class="field-cell employer-cell">
            <input type="text" name="employer[]" aria-label="Employer">
          </td>
          <td class="field-cell start-cell">
            <select name="start_year[]" class="year-select start-year" aria-label="Start year">
              <option value="" disabled selected>-- Year --</option>
            </select>
          </td>
          <td class="field-cell date-cell">
            <select name="end_year[]" class="year-select end-year allow-ongoing" aria-label="End year or ongoing">
              <option value="" disabled selected>-- Year / Present --</option>
            </select>
          </td>
          <td class="field-cell hours-cell">
            <select name="hours_per_week[]" class="hours-select" aria-describedby="hoursHelp" aria-label="Hours per week">
              <option value="" disabled selected>-- Select --</option>
            </select>
          </td>
          <td class="actions">
            <button type="button" class="delete-btn" aria-label="Delete row">
              <svg viewBox="0 0 24 24" role="img" aria-hidden="true">
                <path d="M9 3a1 1 0 0 0-.894.553L7.382 5H5a1 1 0 1 0 0 2h14a1 1 0 1 0 0-2h-2.382l-.724-1.447A1 1 0 0 0 14.999 3H9Zm-3 6v10a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V9H6Zm4 2a1 1 0 0 1 2 0v8a1 1 0 1 1-2 0v-8Zm4-1a1 1 0 0 1 1 1v8a1 1 0 1 1-2 0v-8a1 1 0 0 1 1-1Z"/>
              </svg>
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <span id="hoursHelp" class="helper-text">Approximate if unsure.</span>

    <button type="button" id="addRowBtn" class="add-btn">+ Add Row</button>
  </form>
</div>

<script>
(function () {
  const tableBody = document.querySelector('#employmentTable tbody');
  const addRowBtn = document.getElementById('addRowBtn');
  const currentYear = new Date().getFullYear();
  const earliestYear = 1950;
  const hourRanges = [
    { value: '0-5', label: '0-5 hours' },
    { value: '5-10', label: '5-10 hours' },
    { value: '10-15', label: '10-15 hours' },
    { value: '15-20', label: '15-20 hours' },
    { value: '20-25', label: '20-25 hours' },
    { value: '25-30', label: '25-30 hours' },
    { value: '30-35', label: '30-35 hours' },
    { value: '35-40', label: '35-40 hours' },
    { value: '40-plus', label: 'More than 40 hours' }
  ];

  function populateYearSelect(select) {
    if (!select || select.dataset.initialized === 'true') return;
    const placeholder = select.querySelector('option[value=""]')?.textContent || '-- Year --';
    select.innerHTML = `<option value="" disabled selected>${placeholder}</option>`;
    if (select.classList.contains('allow-ongoing')) {
      const ongoingOption = document.createElement('option');
      ongoingOption.value = 'present';
      ongoingOption.textContent = 'Present / Still employed';
      select.appendChild(ongoingOption);
    }
    for (let year = currentYear; year >= earliestYear; year -= 1) {
      const option = document.createElement('option');
      option.value = String(year);
      option.textContent = year;
      select.appendChild(option);
    }
    select.dataset.initialized = 'true';
  }

  function populateHoursSelect(select) {
    if (!select || select.dataset.initialized === 'true') return;
    select.innerHTML = '<option value="" disabled selected>-- Select --</option>';
    hourRanges.forEach(({ value, label }) => {
      const option = document.createElement('option');
      option.value = value;
      option.textContent = label;
      select.appendChild(option);
    });
    select.dataset.initialized = 'true';
  }

  function resetRow(row) {
    row.querySelectorAll('textarea').forEach((textarea) => {
      textarea.value = '';
    });
    row.querySelectorAll('select').forEach((select) => {
      select.value = '';
    });
  }

  function bindRow(row) {
    const endYearSelect = row.querySelector('.end-year');
    const deleteBtn = row.querySelector('.delete-btn');

    populateYearSelect(row.querySelector('.start-year'));
    populateYearSelect(endYearSelect);
    populateHoursSelect(row.querySelector('.hours-select'));

    if (deleteBtn) {
      deleteBtn.addEventListener('click', () => {
        const rows = tableBody.querySelectorAll('tr');
        if (rows.length > 1) {
          row.remove();
        } else {
          resetRow(row);
        }
      });
    }
  }

  function addRow() {
    const templateRow = tableBody.rows[0];
    const newRow = templateRow.cloneNode(true);
    resetRow(newRow);
    tableBody.appendChild(newRow);
    bindRow(newRow);
  }

  addRowBtn.addEventListener('click', addRow);
  Array.from(tableBody.rows).forEach(bindRow);
})();
</script>

</body>
</html>
